(()=>{"use strict";var e,t;(t=e||(e={}))[t.Undefined=0]="Undefined",t[t.Text=1]="Text",t[t.Language=2]="Language";const n=e=>{if(e)return e?.value||e?.target?.value||e?.innerHTML},o=e=>{const t=document.createElement("div");t.textContent=e,t.id="hcktest",t.style.cssText="\n        position: absolute;\n        background-color: white;\n        padding: 5px;\n        border-radius: 5px;\n        z-index: 10;\n        height: 'fit-conten';\n        width: 'fit-content';\n        margin-top: 50px;\n    \n        z-index: 10;\n        display: inline-block;\n        padding: 0.75rem 1rem;\n        font-size: 0.875rem;\n        font-weight: 500;\n        color: #fff;\n        border-radius: 0.375rem;\n        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05), 0 1px 3px 1px rgba(0, 0, 0, 0.1);\n        opacity: 1;\n    \n        background-color: rgb(34 197 94);\n    ";const n=document.activeElement,o=n.nextSibling;o&&o.parentElement===n.parentElement&&n.parentElement.insertBefore(t,o)},i=()=>{var e=document?.querySelectorAll("#hcktest");e&&e.forEach((e=>{e.remove()}))},r=e=>{const t=e.mistake,n=document.activeElement,r=n?.value||n?.target?.value||n?.innerHTML,c=[],s=[...r.matchAll(t)];for(const l of s){const s=l.index;if(!c.includes(s)){c.push(s);const u=a(t,getComputedStyle(n).fontSize,getComputedStyle(n).fontFamily),m=r.substring(0,s),g=(r.substring(s+t.length),a(m,getComputedStyle(n).fontSize,getComputedStyle(n).fontFamily));let p=d(n,t);const f=document.createElement("div");f.classList.add("grammarlyHighlight"),f.id=`grammar-pt-${l.index}`;let x=Math.floor(n.parentElement.getBoundingClientRect().left+g);x>n.getBoundingClientRect().width&&(x-=n.getBoundingClientRect().width,p*=2),f.style.cssText=`\n                box-sizing: content-box;\n                position: absolute;\n                pointer-events: auto;\n                overflow: hidden;\n                border: 0;\n                border-radius: 0;\n                padding: 0;\n                margin: 0;\n                background-color: rgba(255, 153, 171, 0.5);\n                top: ${p}px;\n                left: ${x}px;\n                width: ${u}px;\n                height: 3px;\n                z-index: 9999;\n            `;const h=n.nextSibling;h&&h.parentElement===n.parentElement&&(document.getElementById(f.id)||n.parentElement.insertBefore(f,h)),f.addEventListener("mouseover",(function(){o(e.correction)})),f.addEventListener("mouseleave",i)}}};function a(e,t,n){const o=document.createElement("canvas").getContext("2d");return o.font=`${t} ${n}`,o.measureText(e).width}const d=(e,t)=>{const n=document.createElement("canvas").getContext("2d"),o=getComputedStyle(e).fontSize,i=getComputedStyle(e).fontFamily;n.font=`${o} ${i}`;const r=n.measureText(t),a=r.fontBoundingBoxAscent+r.fontBoundingBoxDescent,d=r.actualBoundingBoxAscent+r.actualBoundingBoxDescent;return Math.floor(a+d)};function c(){document.querySelectorAll('[id^="grammar-pt-"]').forEach((e=>{e.remove()}));const e=document.activeElement;r(e)}const s=()=>{const t=document.activeElement;chrome.runtime.sendMessage({type:e.Text,value:n(t)})};document.addEventListener("keydown",(function(e){"Backspace"===e.key||"Delete"===e.key?c():(clearTimeout(window.setTimeout),window.setTimeout(s,2500))})),window.addEventListener("resize",c),chrome.runtime.onMessage.addListener((function(e,t,n){"4"==e?.type&&JSON.parse(e.message).length>0&&JSON.parse(e?.message).forEach((e=>{r(e)}))}))})();